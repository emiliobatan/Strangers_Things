(this.webpackJsonpstangersthings=this.webpackJsonpstangersthings||[]).push([[0],{31:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n(18),c=n.n(r),a=n(9),o=n(3),i=n.n(o),u=n(6),l=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,s,r,c,a,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,s=t.method,r=t.token,c=t.body,e.prev=1,a={method:s?s.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)},r&&(a.headers.Authorization="Bearer ".concat(r)),e.next=6,fetch("".concat("https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT").concat(n),a);case 6:return o=e.sent,e.next=9,o.json();case 9:if(!(u=e.sent).error){e.next=12;break}throw u.error;case 12:return e.abrupt("return",u);case 15:e.prev=15,e.t0=e.catch(1),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),j=n(0),b=function(e){var t=e.posts,n=e.token,s=e.fetchPosts,r=function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({method:"DELETE",url:"/posts/".concat(t),token:n});case 2:return r=e.sent,console.log("respObj: ",r),e.next=6,s();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(j.Fragment,{children:t.map((function(e){return Object(j.jsxs)(g,{post:e,token:n,children:[Object(j.jsx)(a.b,{to:"/posts/".concat(e._id),children:"  View Post "})," |",e.isAuthor&&Object(j.jsx)("button",{onClick:function(){return r(e._id)},children:"Delete"})]},e._id)}))})},d=n(4),h=function(e){var t=e.token,n=e.setPosts,r=Object(s.useState)(""),c=Object(d.a)(r,2),a=c[0],o=c[1],b=Object(s.useState)(""),h=Object(d.a)(b,2),p=h[0],O=h[1],x=Object(s.useState)(""),f=Object(d.a)(x,2),g=f[0],v=f[1],m=Object(s.useState)(""),k=Object(d.a)(m,2),S=k[0],y=k[1],w=Object(s.useState)(!1),P=Object(d.a)(w,2),C=P[0],T=P[1],D=function(){var e=Object(u.a)(i.a.mark((function e(s){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),console.log({location:S,description:p,price:g,title:a,willDeliver:C}),e.next=4,l({url:"/posts",method:"POST",token:t,body:{post:{title:a,description:p,price:g,location:S,willDeliver:C}}});case 4:return e.sent,e.next=7,l({url:"/posts",token:t});case 7:r=e.sent,n(r.data.posts);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:" Create a post "}),Object(j.jsxs)("form",{onSubmit:D,children:[Object(j.jsxs)("fieldset",{children:[Object(j.jsx)("label",{children:" Title "}),Object(j.jsx)("input",{type:"text",placeholder:"Enter Title",value:a,onChange:function(e){return o(e.target.value)}})]}),Object(j.jsxs)("fieldset",{children:[Object(j.jsx)("label",{children:" Description "}),Object(j.jsx)("input",{type:"text",placeholder:"Enter Description",value:p,onChange:function(e){return O(e.target.value)}})]}),Object(j.jsxs)("fieldset",{children:[Object(j.jsx)("label",{children:" Price "}),Object(j.jsx)("input",{type:"text",placeholder:"Enter Price",value:g,onChange:function(e){return v(e.target.value)}})]}),Object(j.jsxs)("fieldset",{children:[Object(j.jsx)("label",{children:" Location "}),Object(j.jsx)("input",{type:"text",placeholder:"Enter Location",value:S,onChange:function(e){return y(e.target.value)}})]}),Object(j.jsxs)("fieldset",{children:[Object(j.jsx)("label",{children:" Will Deliver "}),Object(j.jsxs)("select",{type:"text",value:C,onChange:function(e){return T(e.target.value)},children:[Object(j.jsx)("option",{value:"false",children:"No"}),Object(j.jsx)("option",{value:"true",children:"Yes"})]})]}),Object(j.jsx)("button",{type:"submit",children:" Post "})]})]})},p=n(2),O=function(e){var t=e.setToken,n=e.setUser,r=e.setMessages,c=e.setUserId,o=Object(s.useState)(""),b=Object(d.a)(o,2),h=b[0],O=b[1],x=Object(s.useState)(""),f=Object(d.a)(x,2),g=f[0],v=f[1],m=Object(p.f)(),k=Object(p.e)();return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:" Login/Register "}),Object(j.jsxs)("div",{children:[" This is the ",m.method," method. "]}),Object(j.jsxs)("form",{onSubmit:function(){var e=Object(u.a)(i.a.mark((function e(s){var a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,l({url:"/users/".concat(m.method),method:"POST",body:{user:{username:h,password:g}}});case 3:if(a=e.sent,console.log("loginResp:",a),!a.data){e.next=14;break}return e.next=8,l({url:"/users/me",token:a.data.token});case 8:o=e.sent,t(a.data.token),n(o.data.username),c(o.data._id),r(o.data.messages),a.data.token&&k.push("/");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(j.jsx)("input",{type:"text",placeholder:"username",value:h,onChange:function(e){return O(e.target.value)}}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{type:"password",placeholder:"password",value:g,onChange:function(e){return v(e.target.value)}}),Object(j.jsx)("br",{}),"register"===m.method?Object(j.jsx)("input",{type:"password",placeholder:"password",value:g,onChange:function(e){return v(e.target.value)}}):"",!g.value===g.value?Object(j.jsx)("button",{disabled:!g||!h||g.length<7||g!==verPass,children:"Submit"}):Object(j.jsx)("button",{type:"submit",children:"Submit"})]}),"login"===m.method?Object(j.jsx)(a.b,{to:"/user/register",children:" Click here to register"}):Object(j.jsx)(a.b,{to:"/user/login",children:" Click here to login "})]})},x=function(e){var t=e.user;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:" Welcome to Stranger's Things! "}),t?Object(j.jsxs)("div",{children:["Logged in as ",t]}):""]})},f=function(){var e=Object(s.useState)(""),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(""),o=Object(d.a)(c,2),f=o[0],g=o[1],v=Object(s.useState)([]),y=Object(d.a)(v,2),w=y[0],P=y[1],C=Object(s.useState)([]),T=Object(d.a)(C,2),D=T[0],E=T[1],F=Object(s.useState)(""),I=Object(d.a)(F,2),L=I[0],U=I[1],_=function(){var e=Object(u.a)(i.a.mark((function e(){var t,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({url:"/posts",token:n});case 2:t=e.sent,(s=t.data.posts)&&P(s);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){try{_()}catch(e){console.log(e)}}),[n]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:" Stranger's Things "}),Object(j.jsx)(a.b,{to:"/posts",className:"link",children:" Post "})," |",n?Object(j.jsx)(a.b,{to:"/profile",children:" Profile "}):"",n?Object(j.jsx)("button",{className:"logout",onClick:function(){return r("")},children:"Logout"}):Object(j.jsx)(a.b,{to:"/user/login",children:"Login | "}),Object(j.jsx)(a.b,{to:"/Home",children:" Home "}),Object(j.jsxs)("div",{children:[Object(j.jsx)(p.a,{exact:!0,path:"/",children:Object(j.jsx)(x,{user:f,token:n,userId:L,messages:D})}),Object(j.jsxs)(p.a,{exact:!0,path:"/posts",children:[Object(j.jsx)(S,{posts:w,setPosts:P}),n?Object(j.jsx)(h,{token:n,setPosts:P}):null,Object(j.jsx)(b,{posts:w,token:n,fetchPosts:_,setPosts:P})]}),Object(j.jsx)(p.a,{exact:!0,path:"/user/:method",children:Object(j.jsx)(O,{setToken:r,setUser:g,setUserId:U,setMessages:E})}),Object(j.jsx)(p.a,{exact:!0,path:"/posts/:postId",children:Object(j.jsx)(m,{posts:w,token:n,user:f,children:" "})}),Object(j.jsx)(p.a,{exact:!0,path:"/profile",children:Object(j.jsx)(k,{token:n,setPosts:P,setMessages:E,posts:w,messages:D,userId:L})})]})]})},g=function(e){var t=e.post,n=e.children;return t?Object(j.jsxs)("div",{style:{margin:".2rem"},children:[Object(j.jsxs)("h5",{children:["Title: ",t.title]}),Object(j.jsxs)("div",{children:["Description: ",t.description]}),Object(j.jsxs)("div",{children:["Seller: ",t.author.username]}),Object(j.jsxs)("div",{children:["Price: ",t.price]}),Object(j.jsxs)("div",{children:["Will Deliver: ",t.willDeliver?"yes":"no"]}),n]}):"Loading..."},v=function(e){var t=e.post,n=e.token,r=Object(s.useState)(""),c=Object(d.a)(r,2),a=c[0],o=c[1],b=Object(p.e)(),h=function(){var e=Object(u.a)(i.a.mark((function e(s){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),r="/posts/".concat(t._id,"/messages"),e.next=4,l({method:"POST",url:r,token:n,body:{message:{content:a}}});case 4:e.sent,b.push("./");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(j.Fragment,{children:n&&!t.isAuthor?Object(j.jsxs)("form",{onSubmit:h,children:[Object(j.jsx)("input",{value:a,placeholder:"content",onChange:function(e){return o(e.target.value)}}),Object(j.jsx)("button",{type:"submit",children:"Add Comment to Post"})]}):""})},m=function(e){var t=e.posts,n=e.token,s=e.user,r=Object(p.f)().postId;console.log("postId: ",r);var c=t.find((function(e){return e._id===r}));return console.log("post: ",c),Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(g,{post:c,children:[c&&c.messages&&c.messages.map((function(e){return Object(j.jsxs)("div",{children:["message: ",e.content]},e._id)})),Object(j.jsx)(v,{post:c,token:n,user:s})]})})},k=function(e){var t=e.token,n=e.messages,s=e.userId;return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Profile Page"}),t?Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:"Messages Received"}),n.map((function(e){return console.log("message: ",e),Object(j.jsx)(j.Fragment,{children:s!==e.fromUser._id?Object(j.jsxs)("div",{children:[e.post.title,": ",e.fromUser.username," replied: ",e.content]}):""})})),Object(j.jsx)("h3",{children:"Messages Sent"}),n.map((function(e){return console.log("message: ",e),Object(j.jsx)(j.Fragment,{children:s===e.fromUser._id?Object(j.jsxs)("div",{children:[e.post.title,": ",e.fromUser.username," said: ",e.content]}):""})}))]})}):""]})};var S=function(e){var t=e.posts,n=e.setPosts,r=Object(s.useState)(""),c=Object(d.a)(r,2),a=c[0],o=c[1],l=function(){var e=Object(u.a)(i.a.mark((function e(){var t,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,callApi({url:"/posts"});case 2:t=e.sent,(s=t.data.posts)&&n(s);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(){var e=t.filter((function(e){return function(e,t){return e.includes(t)}(e.title.toLowerCase(),a)}));n(e),a.length||l()}()},children:[Object(j.jsx)("input",{type:"text",placeholder:"search...",value:a,onChange:function(e){return o(e.target.value)}}),Object(j.jsx)("button",{type:"submit",children:"Search"})]})})};console.log("APIURL: ","https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT"),c.a.render(Object(j.jsx)(a.a,{children:Object(j.jsx)(f,{})}),document.getElementById("app"))}},[[31,1,2]]]);
//# sourceMappingURL=main.d816d549.chunk.js.map